CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

PROJECT(libxpf)

FILE(GLOB EXPORTED_HEADER_FILES ../include/xpf/*.h)
FILE(GLOB INTERNAL_HEADER_FILES ./platform/posix/*.hpp ./platform/windows/*.hpp)
FILE(GLOB INTERNAL_SRC_FILES ./*.cpp)
SOURCE_GROUP("Public Headers" FILES ${EXPORTED_HEADER_FILES})
SOURCE_GROUP("Private Headers" FILES ${INTERNAL_HEADER_FILES})

FIND_PACKAGE(Threads)

#IF(WIN32)
#FILE(GLOB PLATFORM_DEP_FILES xx_thread_win32.cpp) 
#ELSE(WIN32)
#FILE(GLOB PLATFORM_DEP_FILES xx_thread_posix.cpp)
#ENDIF(WIN32)

INCLUDE_DIRECTORIES("../include")

ADD_LIBRARY(xpf SHARED
  ${INTERNAL_SRC_FILES}
  ${PLATFORM_DEP_FILES}
)
SET_PROPERTY(TARGET xpf PROPERTY ARCHIVE_OUTPUT_DIRECTORY ./bin)
SET_PROPERTY(TARGET xpf PROPERTY RUNTIME_OUTPUT_DIRECTORY ./bin)
SET_PROPERTY(TARGET xpf PROPERTY DEFINE_SYMBOL XPF_BUILD_LIBRARY)
TARGET_LINK_LIBRARIES(xpf ${CMAKE_THREAD_LIBS_INIT})

ADD_LIBRARY(xpf_static STATIC
  ${INTERNAL_SRC_FILES}
  ${PLATFORM_DEP_FILES}
)
SET_PROPERTY(TARGET xpf_static PROPERTY ARCHIVE_OUTPUT_DIRECTORY ./bin)
SET_PROPERTY(TARGET xpf_static APPEND_STRING PROPERTY COMPILE_DEFINITIONS XPF_BUILD_STATIC_LIBRARY)
